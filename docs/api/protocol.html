

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Protocol Documentation &mdash; MW75 EEG Streamer Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=4dd473e5" />

  
    <link rel="shortcut icon" href="_static/favicon.svg"/>
    <link rel="canonical" href="https://arctop.github.io/mw75-streamer/protocol.html"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=1ed6394b"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting Guide" href="troubleshooting.html" />
    <link rel="prev" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #667eea" >

          
          
          <a href="index.html" class="icon icon-home">
            MW75 EEG Streamer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#basic-installation">Basic Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#option-1-from-pypi-recommended">Option 1: From PyPI (Recommended)</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#option-2-from-source">Option 2: From Source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#optional-dependencies">Optional Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#websocket-support">WebSocket Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#lab-streaming-layer-lsl-support">Lab Streaming Layer (LSL) Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#testing-utilities">Testing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#development-dependencies">Development Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#all-dependencies">All Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#documentation-dependencies">Documentation Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#hardware-setup">Hardware Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#mw75-neuro-headphones">MW75 Neuro Headphones</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verification">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#common-installation-issues">Common Installation Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#basic-usage">Basic Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#stream-to-csv-file">Stream to CSV File</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#real-time-websocket-streaming">Real-time WebSocket Streaming</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#lab-streaming-layer-lsl">Lab Streaming Layer (LSL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#combined-output">Combined Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#command-line-options">Command Line Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#core-options">Core Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#understanding-the-data">Understanding the Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#eeg-data-format">EEG Data Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#connection-process">Connection Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#testing-setup">Testing Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#browser-visualization">Browser Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#validation-checklist">Validation Checklist</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#common-issues">Common Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#device-not-found">Device Not Found</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#connection-failed">Connection Failed</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#poor-data-quality">Poor Data Quality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-mw75_streamer.main">Main Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#mw75_streamer.main.MW75Streamer"><code class="docutils literal notranslate"><span class="pre">MW75Streamer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.main.MW75Streamer.device"><code class="docutils literal notranslate"><span class="pre">MW75Streamer.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.main.MW75Streamer.set_verbose"><code class="docutils literal notranslate"><span class="pre">MW75Streamer.set_verbose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.main.MW75Streamer.start_streaming"><code class="docutils literal notranslate"><span class="pre">MW75Streamer.start_streaming()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#mw75_streamer.main.parse_arguments"><code class="docutils literal notranslate"><span class="pre">parse_arguments()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#mw75_streamer.main.show_output_configuration"><code class="docutils literal notranslate"><span class="pre">show_output_configuration()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#mw75_streamer.main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#mw75_streamer.main.cli_main"><code class="docutils literal notranslate"><span class="pre">cli_main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#device-management">Device Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.device.mw75_device">MW75 Device Controller</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.device.mw75_device.MW75Device"><code class="docutils literal notranslate"><span class="pre">MW75Device</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.device.ble_manager">BLE Manager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.device.ble_manager.BLEManager"><code class="docutils literal notranslate"><span class="pre">BLEManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.device.rfcomm_manager">RFCOMM Manager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.device.rfcomm_manager.RFCOMMDelegate"><code class="docutils literal notranslate"><span class="pre">RFCOMMDelegate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.device.rfcomm_manager.RFCOMMManager"><code class="docutils literal notranslate"><span class="pre">RFCOMMManager</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#data-processing">Data Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.data.packet_processor">Packet Processor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.packet_processor.EEGPacket"><code class="docutils literal notranslate"><span class="pre">EEGPacket</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.packet_processor.ChecksumStats"><code class="docutils literal notranslate"><span class="pre">ChecksumStats</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.packet_processor.PacketProcessor"><code class="docutils literal notranslate"><span class="pre">PacketProcessor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.data.streamers">Streamers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.streamers.CSVWriter"><code class="docutils literal notranslate"><span class="pre">CSVWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.streamers.WebSocketStreamer"><code class="docutils literal notranslate"><span class="pre">WebSocketStreamer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.streamers.StdoutStreamer"><code class="docutils literal notranslate"><span class="pre">StdoutStreamer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.data.streamers.LSLStreamer"><code class="docutils literal notranslate"><span class="pre">LSLStreamer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-mw75_streamer.config">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#testing-utilities">Testing Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.testing.websocket_server">WebSocket Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.websocket_server.SimpleWebSocketServer"><code class="docutils literal notranslate"><span class="pre">SimpleWebSocketServer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.websocket_server.WebSocketTestServer"><code class="docutils literal notranslate"><span class="pre">WebSocketTestServer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.websocket_server.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.testing.test_guide">Test Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.test_guide.TestGuide"><code class="docutils literal notranslate"><span class="pre">TestGuide</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.test_guide.show_quick_start"><code class="docutils literal notranslate"><span class="pre">show_quick_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.test_guide.open_browser_test"><code class="docutils literal notranslate"><span class="pre">open_browser_test()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.testing.test_guide.validate_test_setup"><code class="docutils literal notranslate"><span class="pre">validate_test_setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.panel.panel_server">Panel Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.panel.panel_server.PanelServer"><code class="docutils literal notranslate"><span class="pre">PanelServer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.panel.panel_server.WebSocketLogHandler"><code class="docutils literal notranslate"><span class="pre">WebSocketLogHandler</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#utilities">Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-mw75_streamer.utils.logging">Logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.utils.logging.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#mw75_streamer.utils.logging.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#data-structures">Data Structures</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Protocol Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#connection-architecture">Connection Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ble-activation-sequence">BLE Activation Sequence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ble-command-details">BLE Command Details</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rfcomm-data-streaming">RFCOMM Data Streaming</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#connection-parameters">Connection Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#packet-structure">Packet Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eeg-channel-layout">EEG Channel Layout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-validation">Data Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#packet-validation">Packet Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checksum-calculation">Checksum Calculation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-processing-pipeline">Data Processing Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-types">Event Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eeg-data-events">EEG Data Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-events">Other Events</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#error-conditions">Error Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#packet-validation-failures">Packet Validation Failures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connection-issues">Connection Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#expected-performance">Expected Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bandwidth-requirements">Bandwidth Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#platform-specific-details">Platform-Specific Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#macos-implementation">macOS Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#future-platform-support">Future Platform Support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#installation-issues">Installation Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#pyobjc-installation-fails">PyObjC Installation Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#lsl-library-not-found">LSL Library Not Found</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#connection-issues">Connection Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#mw75-device-not-found">MW75 Device Not Found</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#ble-activation-fails">BLE Activation Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#rfcomm-connection-lost">RFCOMM Connection Lost</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#data-quality-issues">Data Quality Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#high-packet-loss">High Packet Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#many-disconnected-electrodes">Many Disconnected Electrodes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#output-issues">Output Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#csv-files-not-created">CSV Files Not Created</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#websocket-connection-failed">WebSocket Connection Failed</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#lsl-stream-not-visible">LSL Stream Not Visible</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#performance-issues">Performance Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#high-cpu-usage">High CPU Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#high-memory-usage">High Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#getting-help">Getting Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#enable-verbose-logging">Enable Verbose Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#collect-system-information">Collect System Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#report-issues">Report Issues</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #667eea" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MW75 EEG Streamer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Protocol Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/protocol.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="protocol-documentation">
<h1>Protocol Documentation<a class="headerlink" href="#protocol-documentation" title="Link to this heading"></a></h1>
<p>This section provides technical details about the MW75 Neuro headphone communication protocol.</p>
<section id="connection-architecture">
<h2>Connection Architecture<a class="headerlink" href="#connection-architecture" title="Link to this heading"></a></h2>
<p>The MW75 EEG Streamer uses a two-phase connection approach:</p>
<ol class="arabic simple">
<li><p><strong>BLE Activation Phase</strong> - Bluetooth Low Energy for device activation</p></li>
<li><p><strong>RFCOMM Streaming Phase</strong> - Bluetooth Classic for high-speed data streaming</p></li>
</ol>
</section>
<section id="ble-activation-sequence">
<h2>BLE Activation Sequence<a class="headerlink" href="#ble-activation-sequence" title="Link to this heading"></a></h2>
<p>The BLE phase activates EEG mode on the MW75 headphones:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1. Discover MW75 device via BLE scan
2. Connect to BLE service
3. Send ENABLE_EEG command
4. Wait 300ms (critical timing)
5. Send ENABLE_RAW_MODE command
6. Wait 300ms (critical timing)
7. Send START_SESSION command
8. Disconnect BLE
</pre></div>
</div>
<p><strong>Critical Timing Requirements:</strong>
- 300ms delays between activation commands are mandatory
- Commands must be sent in exact sequence
- BLE connection remains active during RFCOMM streaming</p>
<section id="ble-command-details">
<h3>BLE Command Details<a class="headerlink" href="#ble-command-details" title="Link to this heading"></a></h3>
<p>Commands are sent to the MW75’s BLE characteristic:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ENABLE_EEG</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">])</span>      <span class="c1"># Enable EEG mode</span>
<span class="n">ENABLE_RAW_MODE</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">])</span> <span class="c1"># Enable raw data mode</span>
<span class="n">START_SESSION</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">])</span>   <span class="c1"># Start streaming session</span>
</pre></div>
</div>
</section>
</section>
<section id="rfcomm-data-streaming">
<h2>RFCOMM Data Streaming<a class="headerlink" href="#rfcomm-data-streaming" title="Link to this heading"></a></h2>
<p>After BLE activation, the headphones begin streaming data over RFCOMM channel 25.</p>
<section id="connection-parameters">
<h3>Connection Parameters<a class="headerlink" href="#connection-parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Protocol</strong>: Bluetooth Classic RFCOMM</p></li>
<li><p><strong>Channel</strong>: 25</p></li>
<li><p><strong>Target Data Rate</strong>: ~500Hz (2ms intervals)</p></li>
<li><p><strong>Packet Structure</strong>: 63 bytes per logical packet</p></li>
<li><p><strong>Transport Chunks</strong>: multiples of 64 bytes</p></li>
</ul>
</section>
</section>
<section id="packet-structure">
<h2>Packet Structure<a class="headerlink" href="#packet-structure" title="Link to this heading"></a></h2>
<p>Each logical data packet is exactly 63 bytes with the following structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Byte 0:    Sync Byte (0xAA)
Byte 1:    Event ID (239 for EEG data)
Byte 2:    Data Length (0x3C = 60 bytes)
Byte 3:    Counter (increments each packet)
Bytes 4-7:  REF channel (float32, microvolts)
Bytes 8-11: DRL channel (float32, microvolts)
Bytes 12-59: 12 EEG channels (float32 each, raw ADC values)
Byte 60:   Feature Status flags
Bytes 61-62: 16-bit checksum
</pre></div>
</div>
<section id="eeg-channel-layout">
<h3>EEG Channel Layout<a class="headerlink" href="#eeg-channel-layout" title="Link to this heading"></a></h3>
<p>The 12 EEG channels (bytes 12-59) represent different electrode positions:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>CH1-CH12: Raw ADC values from electrode array

Conversion: raw_adc_value × 0.023842 = microvolts
Disconnection: value 8388607 indicates electrode not connected
</pre></div>
</div>
</section>
</section>
<section id="data-validation">
<h2>Data Validation<a class="headerlink" href="#data-validation" title="Link to this heading"></a></h2>
<section id="packet-validation">
<h3>Packet Validation<a class="headerlink" href="#packet-validation" title="Link to this heading"></a></h3>
<p>Each packet undergoes validation:</p>
<ol class="arabic simple">
<li><p><strong>Sync Byte Check</strong> - Must be 0xAA</p></li>
<li><p><strong>Packet Size Check</strong> - Must be exactly 63 bytes</p></li>
<li><p><strong>Checksum Verification</strong> - 16-bit sum of first 61 bytes</p></li>
<li><p><strong>Counter Extraction</strong> - Counter value extracted for monitoring (rollover at 255)</p></li>
</ol>
</section>
<section id="checksum-calculation">
<h3>Checksum Calculation<a class="headerlink" href="#checksum-calculation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_checksum</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate 16-bit checksum of first 61 bytes.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">61</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
</pre></div>
</div>
</section>
</section>
<section id="data-processing-pipeline">
<h2>Data Processing Pipeline<a class="headerlink" href="#data-processing-pipeline" title="Link to this heading"></a></h2>
<p>Raw Packet → Validation → Conversion → Output</p>
<ol class="arabic simple">
<li><p><strong>Receive 63-byte packet</strong> from RFCOMM connection</p></li>
<li><p><strong>Validate packet structure</strong> (sync, size, checksum)</p></li>
<li><p><strong>Parse channels</strong> using struct.unpack for float32 values</p></li>
<li><p><strong>Convert EEG channels</strong> from raw ADC to microvolts</p></li>
<li><p><strong>Filter by event type</strong> (EEG vs other events)</p></li>
<li><p><strong>Route to outputs</strong> (CSV, WebSocket, LSL, etc.)</p></li>
</ol>
</section>
<section id="event-types">
<h2>Event Types<a class="headerlink" href="#event-types" title="Link to this heading"></a></h2>
<p>The MW75 headphones generate different event types:</p>
<section id="eeg-data-events">
<h3>EEG Data Events<a class="headerlink" href="#eeg-data-events" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Event ID</strong>: 239</p></li>
<li><p><strong>Target Frequency</strong>: ~500Hz</p></li>
<li><p><strong>Content</strong>: 12-channel EEG + REF/DRL + metadata</p></li>
</ul>
</section>
<section id="other-events">
<h3>Other Events<a class="headerlink" href="#other-events" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Event IDs</strong>: Various (non-239)</p></li>
<li><p><strong>Frequency</strong>: Irregular</p></li>
<li><p><strong>Content</strong>: Device status, battery, configuration changes</p></li>
</ul>
</section>
</section>
<section id="error-conditions">
<h2>Error Conditions<a class="headerlink" href="#error-conditions" title="Link to this heading"></a></h2>
<p>Common error conditions and their handling (see <a class="reference internal" href="troubleshooting.html"><span class="doc">Troubleshooting Guide</span></a> for detailed solutions):</p>
<section id="packet-validation-failures">
<h3>Packet Validation Failures<a class="headerlink" href="#packet-validation-failures" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Invalid sync byte</strong> - Packet discarded, connection maintained</p></li>
<li><p><strong>Checksum mismatch</strong> - Packet discarded, logged as warning</p></li>
</ul>
</section>
<section id="connection-issues">
<h3>Connection Issues<a class="headerlink" href="#connection-issues" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>BLE activation timeout</strong> - Retry with exponential backoff</p></li>
<li><p><strong>RFCOMM connection lost</strong> - Attempt reconnection</p></li>
<li><p><strong>No data received</strong> - Check device power and pairing</p></li>
</ul>
</section>
</section>
<section id="performance-characteristics">
<h2>Performance Characteristics<a class="headerlink" href="#performance-characteristics" title="Link to this heading"></a></h2>
<section id="expected-performance">
<h3>Expected Performance<a class="headerlink" href="#expected-performance" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Target Data Rate</strong>: 500 packets/second (2ms intervals)</p></li>
<li><p><strong>Target Packet Loss</strong>: &lt;0.1% under optimal conditions</p></li>
<li><p><strong>Expected CPU Usage</strong>: ~2-5% on modern macOS systems</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Performance characteristics may vary based on environmental conditions and system configuration.</p>
</div>
</section>
<section id="bandwidth-requirements">
<h3>Bandwidth Requirements<a class="headerlink" href="#bandwidth-requirements" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Target Logical Data</strong>: ~31.5 KB/s (500Hz × 63 bytes logical packets)</p></li>
<li><p><strong>WebSocket JSON</strong>: ~85 KB/s (with JSON overhead)</p></li>
<li><p><strong>CSV Output</strong>: ~45 KB/s (text format)</p></li>
</ul>
</section>
</section>
<section id="platform-specific-details">
<h2>Platform-Specific Details<a class="headerlink" href="#platform-specific-details" title="Link to this heading"></a></h2>
<section id="macos-implementation">
<h3>macOS Implementation<a class="headerlink" href="#macos-implementation" title="Link to this heading"></a></h3>
<p>Uses PyObjC bindings for macOS Bluetooth frameworks:</p>
<ul class="simple">
<li><p><strong>IOBluetooth</strong> for BLE operations</p></li>
<li><p><strong>IOBluetoothDevice</strong> for RFCOMM connections</p></li>
<li><p><strong>Core Bluetooth</strong> integration via PyObjC</p></li>
</ul>
</section>
<section id="future-platform-support">
<h3>Future Platform Support<a class="headerlink" href="#future-platform-support" title="Link to this heading"></a></h3>
<p>Planned implementations for Linux and Windows:</p>
<ul class="simple">
<li><p><strong>Linux</strong>: BlueZ via D-Bus or direct socket access</p></li>
<li><p><strong>Windows</strong>: Windows Bluetooth API via pywin32</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Arctop.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>